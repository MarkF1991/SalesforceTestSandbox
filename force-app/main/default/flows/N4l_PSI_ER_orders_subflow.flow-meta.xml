<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Error_message_to_PS</name>
        <label>Error message to PS</label>
        <locationX>1722</locationX>
        <locationY>1730</locationY>
        <actionName>PostApiForErrorMessagesController</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>action</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value12</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>errorMessages</name>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>eventType</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value13</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>internalReferenceId</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value14</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>origin</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value15</elementReference>
            </value>
        </inputParameters>
        <nameSegment>PostApiForErrorMessagesController</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>Error_message_to_PS_0</name>
        <label>Error message to PS</label>
        <locationX>2338</locationX>
        <locationY>1946</locationY>
        <actionName>PostApiForErrorMessagesController</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>action</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value12</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>errorMessages</name>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>eventType</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value13</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>internalReferenceId</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value14</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>origin</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value15</elementReference>
            </value>
        </inputParameters>
        <nameSegment>PostApiForErrorMessagesController</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <description>Error_message_to_PS_1</description>
        <name>Error_message_to_PS_1</name>
        <label>Error message to PS</label>
        <locationX>490</locationX>
        <locationY>2438</locationY>
        <actionName>PostApiForErrorMessagesController</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>action</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value12</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>errorMessages</name>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>eventType</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value13</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>internalReferenceId</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value14</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>origin</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value15</elementReference>
            </value>
        </inputParameters>
        <nameSegment>PostApiForErrorMessagesController</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <description>Error_message_to_PS_2</description>
        <name>Error_message_to_PS_2</name>
        <label>Error message to PS</label>
        <locationX>1106</locationX>
        <locationY>1298</locationY>
        <actionName>PostApiForErrorMessagesController</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>action</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value12</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>errorMessages</name>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>eventType</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value13</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>internalReferenceId</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value14</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>origin</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value15</elementReference>
            </value>
        </inputParameters>
        <nameSegment>PostApiForErrorMessagesController</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>Get_orderItems_value_from_Collection</name>
        <label>Get orderItems value from Collection</label>
        <locationX>1546</locationX>
        <locationY>1214</locationY>
        <actionName>MultipleJSONParser</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Prepare_value_for_orderItem_creation</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>fieldName1</name>
            <value>
                <stringValue>quantity</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName2</name>
            <value>
                <stringValue>productId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName3</name>
            <value>
                <stringValue>lineDescription</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName4</name>
            <value>
                <stringValue>salesforcePriceBookEntryId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName5</name>
            <value>
                <stringValue>cost</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName6</name>
            <value>
                <stringValue>moeFunded</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ignore_error</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>jsonStringToParse</name>
            <value>
                <elementReference>Loop_through_to_the_orderItems_Collection</elementReference>
            </value>
        </inputParameters>
        <nameSegment>MultipleJSONParser</nameSegment>
        <storeOutputAutomatically>true</storeOutputAutomatically>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>Get_orderItems_value_from_Collection_0</name>
        <label>Get orderItems value from Collection</label>
        <locationX>2162</locationX>
        <locationY>1430</locationY>
        <actionName>MultipleJSONParser</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Prepare_value_for_orderItem_creation_0</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>fieldName1</name>
            <value>
                <stringValue>quantity</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName2</name>
            <value>
                <stringValue>productId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName3</name>
            <value>
                <stringValue>lineDescription</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName4</name>
            <value>
                <stringValue>salesforcePriceBookEntryId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName5</name>
            <value>
                <stringValue>cost</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName6</name>
            <value>
                <stringValue>orderItemId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName7</name>
            <value>
                <stringValue>moeFunded</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ignore_error</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>jsonStringToParse</name>
            <value>
                <elementReference>Loop_through_to_the_orderItems_Collection_0</elementReference>
            </value>
        </inputParameters>
        <nameSegment>MultipleJSONParser</nameSegment>
        <storeOutputAutomatically>true</storeOutputAutomatically>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <description>Get_orderItems_value_from_Collection_1</description>
        <name>Get_orderItems_value_from_Collection_1</name>
        <label>Get orderItems value from Collection</label>
        <locationX>270</locationX>
        <locationY>1922</locationY>
        <actionName>MultipleJSONParser</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Prepare_value_for_orderItem_creation_1</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>fieldName1</name>
            <value>
                <stringValue>quantity</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName2</name>
            <value>
                <stringValue>productId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName3</name>
            <value>
                <stringValue>lineDescription</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName4</name>
            <value>
                <stringValue>salesforcePriceBookEntryId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName5</name>
            <value>
                <stringValue>cost</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName6</name>
            <value>
                <stringValue>moeFunded</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ignore_error</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>jsonStringToParse</name>
            <value>
                <elementReference>Loop</elementReference>
            </value>
        </inputParameters>
        <nameSegment>MultipleJSONParser</nameSegment>
        <storeOutputAutomatically>true</storeOutputAutomatically>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <description>Get_orderItems_value_from_Collection_2</description>
        <name>Get_orderItems_value_from_Collection_2</name>
        <label>Get orderItems value from Collection</label>
        <locationX>930</locationX>
        <locationY>782</locationY>
        <actionName>MultipleJSONParser</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Prepare_value_for_orderItem_creation_2</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>fieldName1</name>
            <value>
                <stringValue>quantity</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName2</name>
            <value>
                <stringValue>productId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName3</name>
            <value>
                <stringValue>lineDescription</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName4</name>
            <value>
                <stringValue>salesforcePriceBookEntryId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName5</name>
            <value>
                <stringValue>cost</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName6</name>
            <value>
                <stringValue>moeFunded</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ignore_error</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>jsonStringToParse</name>
            <value>
                <elementReference>Loop_0</elementReference>
            </value>
        </inputParameters>
        <nameSegment>MultipleJSONParser</nameSegment>
        <storeOutputAutomatically>true</storeOutputAutomatically>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>Get_values_for_order_creation</name>
        <label>Get values for order creation</label>
        <locationX>1106</locationX>
        <locationY>134</locationY>
        <actionName>MultipleJSONParser</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>OrderItems_to_the_Collection</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>fieldName1</name>
            <value>
                <stringValue>data.orderId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName10</name>
            <value>
                <stringValue>data.type</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName11</name>
            <value>
                <stringValue>data.items</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName12</name>
            <value>
                <stringValue>header.action</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName13</name>
            <value>
                <stringValue>header.eventType</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName14</name>
            <value>
                <stringValue>header.internalReferenceId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName15</name>
            <value>
                <stringValue>header.origin</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName16</name>
            <value>
                <stringValue>data.description</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName17</name>
            <value>
                <stringValue>data.contractType</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName18</name>
            <value>
                <stringValue>data.contractId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName2</name>
            <value>
                <stringValue>data.schoolId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName3</name>
            <value>
                <stringValue>data.caseId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName4</name>
            <value>
                <stringValue>data.salesforcePriceBookId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName5</name>
            <value>
                <stringValue>data.EffectiveDate</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName6</name>
            <value>
                <stringValue>data.providerId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName7</name>
            <value>
                <stringValue>data.authorizedById</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName8</name>
            <value>
                <stringValue>data.chargeTo</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>fieldName9</name>
            <value>
                <stringValue>data.returnToId</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>ignore_error</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>jsonStringToParse</name>
            <value>
                <elementReference>PlatformServicesIntegrationRecords.Data__c</elementReference>
            </value>
        </inputParameters>
        <nameSegment>MultipleJSONParser</nameSegment>
        <storeOutputAutomatically>true</storeOutputAutomatically>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>OrderItems_to_the_Collection</name>
        <label>OrderItems to the Collection</label>
        <locationX>1106</locationX>
        <locationY>242</locationY>
        <actionName>JSONToCollection</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Get_current_existing_variation_contract</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>jsonStringToConvert</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value11</elementReference>
            </value>
        </inputParameters>
        <nameSegment>JSONToCollection</nameSegment>
        <storeOutputAutomatically>true</storeOutputAutomatically>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>SendSuccessMessage</name>
        <label>SendSuccessMessage</label>
        <locationX>1458</locationX>
        <locationY>1838</locationY>
        <actionName>PostApiForSuccessMessagesController</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>action</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value12</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>eventType</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value13</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Ids</name>
            <value>
                <elementReference>stringOfAllcreatedOrderItemIds</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>internalReferenceId</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value14</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>origin</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value15</elementReference>
            </value>
        </inputParameters>
        <nameSegment>PostApiForSuccessMessagesController</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>SendSuccessMessage_0</name>
        <label>SendSuccessMessage</label>
        <locationX>2074</locationX>
        <locationY>2054</locationY>
        <actionName>PostApiForSuccessMessagesController</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>action</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value12</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>eventType</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value13</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Ids</name>
            <value>
                <elementReference>stringOfAllcreatedOrderItemIds0</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>internalReferenceId</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value14</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>origin</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value15</elementReference>
            </value>
        </inputParameters>
        <nameSegment>PostApiForSuccessMessagesController</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <description>SendSuccessMessage_2</description>
        <name>SendSuccessMessage_2</name>
        <label>SendSuccessMessage</label>
        <locationX>182</locationX>
        <locationY>2546</locationY>
        <actionName>PostApiForSuccessMessagesController</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Mark_original_contract_orders_as_cancelled</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>action</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value12</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>eventType</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value13</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Ids</name>
            <value>
                <elementReference>stringOfAllCreatedOrderItemsVariation</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>internalReferenceId</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value14</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>origin</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value15</elementReference>
            </value>
        </inputParameters>
        <nameSegment>PostApiForSuccessMessagesController</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <description>SendSuccessMessage_3</description>
        <name>SendSuccessMessage_3</name>
        <label>SendSuccessMessage</label>
        <locationX>842</locationX>
        <locationY>1406</locationY>
        <actionName>PostApiForSuccessMessagesController</actionName>
        <actionType>apex</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>action</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value12</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>eventType</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value13</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>Ids</name>
            <value>
                <elementReference>stringOfAllCreatedOrderItemsVariation0</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>internalReferenceId</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value14</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>origin</name>
            <value>
                <elementReference>Get_values_for_order_creation.Value15</elementReference>
            </value>
        </inputParameters>
        <nameSegment>PostApiForSuccessMessagesController</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <apiVersion>55.0</apiVersion>
    <assignments>
        <name>Assign_contract_Id_s</name>
        <label>Assign contract Id&apos;s</label>
        <locationX>138</locationX>
        <locationY>998</locationY>
        <assignmentItems>
            <assignToReference>Pre_Existing_Variations</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_over_existing_variation_contracts.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_over_existing_variation_contracts</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assign the new (currently active) contract Id to a variable.</description>
        <name>Assign_New_contract_Id</name>
        <label>Assign New contract Id</label>
        <locationX>50</locationX>
        <locationY>3086</locationY>
        <assignmentItems>
            <assignToReference>New_Contract_Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_original_Contract.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_over_related_variation_contracts</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns new values necessary for the new variation to be created based on the original contract.</description>
        <name>Assign_new_variation_values</name>
        <label>Assign new variation values</label>
        <locationX>182</locationX>
        <locationY>1490</locationY>
        <assignmentItems>
            <assignToReference>Get_original_Contract.Contract_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Variation</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Get_original_Contract.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value02</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Get_original_Contract.Parent_Contract__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value18</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Get_original_Contract.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Get_original_Contract.Related_Case__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value03</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Get_original_Contract.Accepted_MoE_Terms_and_Conditions__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Get_original_Contract.Accepted_N4L_Terms_and_Conditions__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Get_original_Contract.Accepted_N4LCharges_Terms_and_Conditions__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_New_Variation_Contract</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assign variation contract Id&apos;s to collection variable.</description>
        <name>Assign_variation_contract_Id_s</name>
        <label>Assign variation contract Id&apos;s</label>
        <locationX>138</locationX>
        <locationY>3302</locationY>
        <assignmentItems>
            <assignToReference>All_Variations</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_over_related_variation_contracts.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_over_related_variation_contracts</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>orderItemRecordsCollection</name>
        <label>orderItemRecordsCollection</label>
        <locationX>1546</locationX>
        <locationY>1430</locationY>
        <assignmentItems>
            <assignToReference>orderItemsCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>orderItemSingleRecord</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_through_to_the_orderItems_Collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>orderItemRecordsCollection_1</description>
        <name>orderItemRecordsCollection_1</name>
        <label>Assign orderItem Records Collection</label>
        <locationX>270</locationX>
        <locationY>2138</locationY>
        <assignmentItems>
            <assignToReference>orderItemsCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>orderItemSingleRecord</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>orderItemRecordsCollection_2</description>
        <name>orderItemRecordsCollection_2</name>
        <label>orderItemRecordsCollection</label>
        <locationX>930</locationX>
        <locationY>998</locationY>
        <assignmentItems>
            <assignToReference>orderItemsCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>orderItemSingleRecord</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>orderItemRecordsCollectionForCreationInUpdateFlow</name>
        <label>orderItemRecordsCollectionForCreationInUpdateFlow</label>
        <locationX>2162</locationX>
        <locationY>1646</locationY>
        <assignmentItems>
            <assignToReference>orderItemCollectionForCreationInUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>orderItemSingleRecordForCreationInUpdate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_through_to_the_orderItems_Collection_0</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Prepare_value_for_orderItem_creation</name>
        <label>Prepare value for orderItem creation</label>
        <locationX>1546</locationX>
        <locationY>1322</locationY>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Quantity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderItemQuantity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Product2Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection.Value02</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection.Value03</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.PricebookEntryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection.Value04</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.UnitPrice</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderItemUnitPrice</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.OrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Create_ER_Order_0</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Discount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderItemDiscount</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>orderItemRecordsCollection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Prepare_value_for_orderItem_creation_0</name>
        <label>Prepare value for orderItem creation</label>
        <locationX>2162</locationX>
        <locationY>1538</locationY>
        <assignmentItems>
            <assignToReference>orderItemSingleRecordForCreationInUpdate.Quantity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderItemQuantityUpdate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecordForCreationInUpdate.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection_0.Value02</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecordForCreationInUpdate.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection_0.Value03</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecordForCreationInUpdate.PricebookEntryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection_0.Value04</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecordForCreationInUpdate.UnitPrice</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderItemUnitPriceUpdate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecordForCreationInUpdate.OrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_existing_order_record.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecordForCreationInUpdate.Discount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderItemDiscountUpdate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>orderItemRecordsCollectionForCreationInUpdateFlow</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Prepare_value_for_orderItem_creation_1</description>
        <name>Prepare_value_for_orderItem_creation_1</name>
        <label>Prepare values for orderItem creation</label>
        <locationX>270</locationX>
        <locationY>2030</locationY>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Quantity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderitemQuantityVariation</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Product2Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection_1.Value02</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection_1.Value03</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.PricebookEntryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection_1.Value04</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.UnitPrice</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderitemUnitPriceVariation</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.OrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Create_ER_Order_1</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Discount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderitemDiscountVariation</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>orderItemRecordsCollection_1</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Prepare_value_for_orderItem_creation_2</description>
        <name>Prepare_value_for_orderItem_creation_2</name>
        <label>Prepare values for orderItem creation</label>
        <locationX>930</locationX>
        <locationY>890</locationY>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Quantity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderitemQuantityVariation0</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Product2Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection_2.Value02</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection_2.Value03</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.PricebookEntryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_orderItems_value_from_Collection_2.Value04</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.UnitPrice</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderitemUnitPriceVariation0</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.OrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Create_ER_Order_2</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderItemSingleRecord.Discount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderitemDiscountVariation0</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>orderItemRecordsCollection_2</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Create_Order_or_Update_Order</name>
        <label>Create Order or Update Order</label>
        <locationX>2030</locationX>
        <locationY>890</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Decision_of_Create_ER_Order</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_values_for_order_creation.Value01</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_ER_Order_0</targetReference>
            </connector>
            <label>Decision of Create ER Order</label>
        </rules>
        <rules>
            <name>Decision_of_Update_ER_Order</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_values_for_order_creation.Value01</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_existing_order_record</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_existing_order_record.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Draft</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_all_orderItems</targetReference>
            </connector>
            <label>Decision of Update ER Order</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether there are any existing variation contracts to be cancelled.
Normally there would not be more than one.</description>
        <name>Do_existing_variation_contracts_exist</name>
        <label>Do existing variation contracts exist?</label>
        <locationX>182</locationX>
        <locationY>782</locationY>
        <defaultConnector>
            <targetReference>Assign_new_variation_values</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_Cancel_existing_variations_and_their_orders</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_all_current_existing_variation_contract</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_over_existing_variation_contracts</targetReference>
            </connector>
            <label>Yes - Cancel existing variations and their orders</label>
        </rules>
    </decisions>
    <decisions>
        <description>Do_existing_variation_contracts_exist_2</description>
        <name>Do_existing_variation_contracts_exist_2</name>
        <label>Do existing variation contracts exist?</label>
        <locationX>182</locationX>
        <locationY>2978</locationY>
        <defaultConnector>
            <targetReference>Clear_active_contract_field_in_current_active_contract</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No</defaultConnectorLabel>
        <rules>
            <name>Yes_Cancel_existing_variations_and_their_orders_2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_all_contracts_with_parent_equal_to_triggering_record_ID</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_New_contract_Id</targetReference>
            </connector>
            <label>Yes - Cancel</label>
        </rules>
    </decisions>
    <decisions>
        <description>Determines whether the event relates to a variation contract and if so whether it is a create or update event.
Non variation contract related events follow the (original) default path.
Logic depends upon presence of &quot;Variation&quot; flag in event JSON and existence of a variation contract already.</description>
        <name>Is_Variation_Required</name>
        <label>Is Variation Required</label>
        <locationX>1106</locationX>
        <locationY>458</locationY>
        <defaultConnector>
            <targetReference>Get_existing_order_record</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_values_for_order_creation.Value17</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Variation</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_original_Contract</targetReference>
            </connector>
            <label>Create Variation Contract</label>
        </rules>
        <rules>
            <name>Existing_Active_Variation</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_current_existing_variation_contract</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_values_for_order_creation.Value17</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Variation</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_ER_Order_2</targetReference>
            </connector>
            <label>Existing Active Variation</label>
        </rules>
    </decisions>
    <description>Amended to cancel orders (in Original and Variations) only if NOT Activated status.
NB: Variation contracts moved to Activated status PRIOR to cancellation of orders and contracts themselves to facilitate cancellation of orders!!</description>
    <environments>Default</environments>
    <formulas>
        <description>From moeFunded in JSON</description>
        <name>orderItemDiscount</name>
        <dataType>Number</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection.Value06})</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <description>From moeFunded in JSON.</description>
        <name>orderItemDiscountUpdate</name>
        <dataType>Number</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection.Value07})</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <name>orderitemDiscountVariation</name>
        <dataType>Currency</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection_1.Value06})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>orderitemDiscountVariation0</name>
        <dataType>Number</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection_2.Value06})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>orderItemQuantity</name>
        <dataType>Number</dataType>
        <expression>Value({!Get_orderItems_value_from_Collection.Value01})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>orderItemQuantityUpdate</name>
        <dataType>Number</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection_0.Value01})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>orderitemQuantityVariation</name>
        <dataType>Number</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection_1.Value01})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>orderitemQuantityVariation0</name>
        <dataType>Number</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection_2.Value01})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>orderItemUnitPrice</name>
        <dataType>Currency</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection.Value05})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>orderItemUnitPriceUpdate</name>
        <dataType>Currency</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection_0.Value05})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>orderitemUnitPriceVariation</name>
        <dataType>Currency</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection_1.Value05})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>orderitemUnitPriceVariation0</name>
        <dataType>Number</dataType>
        <expression>VALUE({!Get_orderItems_value_from_Collection_2.Value05})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Truncate the order description to 255 characters so it can be input into a short text field to filter order rollup to contract record</description>
        <name>orderShortDescription</name>
        <dataType>String</dataType>
        <expression>IF(LEN({!Get_values_for_order_creation.Value16})&gt;255, LEFT({!Get_values_for_order_creation.Value16}, 255), {!Get_values_for_order_creation.Value16})</expression>
    </formulas>
    <formulas>
        <name>OrderStartDate</name>
        <dataType>Date</dataType>
        <expression>DATEVALUE({!Get_values_for_order_creation.Value05} )</expression>
    </formulas>
    <interviewLabel>N4l PSI ER orders subflow {!$Flow.CurrentDateTime}</interviewLabel>
    <label>N4l PSI ER Lite orders subflow</label>
    <loops>
        <description>Loops over the order items in the event JSON code.</description>
        <name>Loop</name>
        <label>Loop over Order Items</label>
        <locationX>182</locationX>
        <locationY>1814</locationY>
        <collectionReference>OrderItems_to_the_Collection.JSONCollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Get_orderItems_value_from_Collection_1</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_OrderItems_1</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over the order items in the event JSON code.</description>
        <name>Loop_0</name>
        <label>Loop</label>
        <locationX>842</locationX>
        <locationY>674</locationY>
        <collectionReference>OrderItems_to_the_Collection.JSONCollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Get_orderItems_value_from_Collection_2</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_OrderItems_2</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over existing, active, variation contracts.</description>
        <name>Loop_over_existing_variation_contracts</name>
        <label>Loop over existing variation contracts</label>
        <locationX>50</locationX>
        <locationY>890</locationY>
        <collectionReference>Get_all_current_existing_variation_contract</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_contract_Id_s</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Cancel_Existing_Variation_Contracts</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_over_related_variation_contracts</name>
        <label>Loop over related variation contracts</label>
        <locationX>50</locationX>
        <locationY>3194</locationY>
        <collectionReference>Get_all_contracts_with_parent_equal_to_triggering_record_ID</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_variation_contract_Id_s</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_active_version_field_on_all_old_records</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_through_to_the_orderItems_Collection</name>
        <label>Loop through to the orderItems Collection</label>
        <locationX>1458</locationX>
        <locationY>1106</locationY>
        <collectionReference>OrderItems_to_the_Collection.JSONCollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Get_orderItems_value_from_Collection</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_OrderItems</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_through_to_the_orderItems_Collection_0</name>
        <label>Loop through to the orderItems Collection</label>
        <locationX>2074</locationX>
        <locationY>1322</locationY>
        <collectionReference>OrderItems_to_the_Collection.JSONCollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Get_orderItems_value_from_Collection_0</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_OrderItems_0</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_ER_Order_0</name>
        <label>Create ER Order</label>
        <locationX>1458</locationX>
        <locationY>998</locationY>
        <connector>
            <targetReference>Loop_through_to_the_orderItems_Collection</targetReference>
        </connector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value02</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Case__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value03</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Charge_To__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value08</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CompanyAuthorizedById</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value07</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContractId</field>
            <value>
                <elementReference>Get_contractId_from_existing_case.Contract__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Description</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value16</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>EffectiveDate</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Pricebook2Id</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value04</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Provider__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value06</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ReturnTo__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value09</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Description__c</field>
            <value>
                <elementReference>orderShortDescription</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value10</elementReference>
            </value>
        </inputAssignments>
        <object>Order</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <description>Create_ER_Order_1
Creates first order for the variation contract.
Subsequent related orders are created in the Existing Active Variation branch.</description>
        <name>Create_ER_Order_1</name>
        <label>Create ER Order</label>
        <locationX>182</locationX>
        <locationY>1706</locationY>
        <connector>
            <targetReference>Loop</targetReference>
        </connector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value02</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Case__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value03</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Charge_To__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value08</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CompanyAuthorizedById</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value07</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContractId</field>
            <value>
                <elementReference>Get_original_Contract.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Description</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value16</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>EffectiveDate</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Pricebook2Id</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value04</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Provider__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value06</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ReturnTo__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value09</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Description__c</field>
            <value>
                <elementReference>orderShortDescription</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value10</elementReference>
            </value>
        </inputAssignments>
        <object>Order</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <description>Create ER Order to be added to an existing variation contract.</description>
        <name>Create_ER_Order_2</name>
        <label>Create ER Order</label>
        <locationX>842</locationX>
        <locationY>566</locationY>
        <connector>
            <targetReference>Loop_0</targetReference>
        </connector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value02</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Case__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value03</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Charge_To__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value08</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CompanyAuthorizedById</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value07</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContractId</field>
            <value>
                <elementReference>Get_current_existing_variation_contract.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Description</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value16</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>EffectiveDate</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Pricebook2Id</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value04</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Provider__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value06</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ReturnTo__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value09</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Description__c</field>
            <value>
                <elementReference>orderShortDescription</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value10</elementReference>
            </value>
        </inputAssignments>
        <object>Order</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <description>Creates a variation contract based upon the original (parent) contract but with  some field values assigned in the assignment above.</description>
        <name>Create_New_Variation_Contract</name>
        <label>Create New Variation Contract</label>
        <locationX>182</locationX>
        <locationY>1598</locationY>
        <connector>
            <targetReference>Create_ER_Order_1</targetReference>
        </connector>
        <inputReference>Get_original_Contract</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Create_OrderItems</name>
        <label>Create OrderItems</label>
        <locationX>1458</locationX>
        <locationY>1622</locationY>
        <connector>
            <targetReference>Get_all_created_orderItemIds</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_message_to_PS</targetReference>
        </faultConnector>
        <inputReference>orderItemsCollection</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Create_OrderItems_0</name>
        <label>Create OrderItems</label>
        <locationX>2074</locationX>
        <locationY>1838</locationY>
        <connector>
            <targetReference>Get_all_created_orderItemIds_0</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_message_to_PS_0</targetReference>
        </faultConnector>
        <inputReference>orderItemCollectionForCreationInUpdate</inputReference>
    </recordCreates>
    <recordCreates>
        <description>Create_OrderItems_1</description>
        <name>Create_OrderItems_1</name>
        <label>Create OrderItems</label>
        <locationX>182</locationX>
        <locationY>2330</locationY>
        <connector>
            <targetReference>Get_all_created_orderItemIds_1</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_message_to_PS_1</targetReference>
        </faultConnector>
        <inputReference>orderItemsCollection</inputReference>
    </recordCreates>
    <recordCreates>
        <description>Create_OrderItems_2</description>
        <name>Create_OrderItems_2</name>
        <label>Create OrderItems</label>
        <locationX>842</locationX>
        <locationY>1190</locationY>
        <connector>
            <targetReference>Get_all_created_orderItemIds_2</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_message_to_PS_2</targetReference>
        </faultConnector>
        <inputReference>orderItemsCollection</inputReference>
    </recordCreates>
    <recordDeletes>
        <name>Delete_all_orderItems</name>
        <label>Delete all orderItems</label>
        <locationX>2074</locationX>
        <locationY>1106</locationY>
        <connector>
            <targetReference>Update_ER_Order</targetReference>
        </connector>
        <inputReference>Get_all_orderItems</inputReference>
    </recordDeletes>
    <recordLookups>
        <description>Gets all contracts related to the Master record.
Used below to stamp the current active contract reference on all cancelled versions.</description>
        <name>Get_all_contracts_with_parent_equal_to_triggering_record_ID</name>
        <label>Get all contracts with parent equal to triggering record ID</label>
        <locationX>182</locationX>
        <locationY>2870</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Do_existing_variation_contracts_exist_2</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Parent_Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value18</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contract</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_all_created_orderItemIds</name>
        <label>Get all created orderItemIds</label>
        <locationX>1458</locationX>
        <locationY>1730</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SendSuccessMessage</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Create_ER_Order_0</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItem</object>
        <queriedFields>Id</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_all_created_orderItemIds_0</name>
        <label>Get all created orderItemIds</label>
        <locationX>2074</locationX>
        <locationY>1946</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SendSuccessMessage_0</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_existing_order_record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItem</object>
        <queriedFields>Id</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get_all_created_orderItemIds_1</description>
        <name>Get_all_created_orderItemIds_1</name>
        <label>Get all created orderItemIds</label>
        <locationX>182</locationX>
        <locationY>2438</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SendSuccessMessage_2</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Create_ER_Order_1</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItem</object>
        <queriedFields>Id</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get_all_created_orderItemIds_2</description>
        <name>Get_all_created_orderItemIds_2</name>
        <label>Get all created orderItemIds</label>
        <locationX>842</locationX>
        <locationY>1298</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SendSuccessMessage_3</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Create_ER_Order_1</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItem</object>
        <queriedFields>Id</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Gets all existing variation contracts which are not already cancelled.</description>
        <name>Get_all_current_existing_variation_contract</name>
        <label>Get all current existing variation contract</label>
        <locationX>182</locationX>
        <locationY>674</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Do_existing_variation_contracts_exist</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Parent_Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value18</elementReference>
            </value>
        </filters>
        <filters>
            <field>Contract_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Variation</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contract</object>
        <sortField>Id</sortField>
        <sortOrder>Asc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_all_orderItems</name>
        <label>Get all orderItems</label>
        <locationX>2074</locationX>
        <locationY>998</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Delete_all_orderItems</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_existing_order_record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_contractId_from_existing_case</name>
        <label>Get contractId from existing case</label>
        <locationX>2030</locationX>
        <locationY>674</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_existing_orderItem_Ids</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value03</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Case</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>Contract__c</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Gets the current (most recent, non-cancelled) variation contract</description>
        <name>Get_current_existing_variation_contract</name>
        <label>Get current existing variation contract</label>
        <locationX>1106</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_Variation_Required</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Parent_Contract__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value18</elementReference>
            </value>
        </filters>
        <filters>
            <field>Contract_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Variation</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contract</object>
        <sortField>ContractNumber</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_existing_order_record</name>
        <label>Get existing order record</label>
        <locationX>2030</locationX>
        <locationY>566</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_contractId_from_existing_case</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value01</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Order</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_existing_orderItem_Ids</name>
        <label>Get existing orderItem Ids</label>
        <locationX>2030</locationX>
        <locationY>782</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Create_Order_or_Update_Order</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OrderId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_existing_order_record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OrderItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Fetches the original Parent (Master) contract.
Design Tool events refer to original contract Id.</description>
        <name>Get_original_Contract</name>
        <label>Get original Contract</label>
        <locationX>182</locationX>
        <locationY>566</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_all_current_existing_variation_contract</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value18</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contract</object>
        <sortField>Id</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <description>Cancels any existing, active, variation contracts.</description>
        <name>Cancel_Existing_Variation_Contracts</name>
        <label>Cancel Existing Variation Contracts</label>
        <locationX>50</locationX>
        <locationY>1190</locationY>
        <connector>
            <targetReference>Cancel_Existing_Variation_Orders</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>In</operator>
            <value>
                <elementReference>Pre_Existing_Variations</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <description>Cancels all orders on existing, active, variation contracts.</description>
        <name>Cancel_Existing_Variation_Orders</name>
        <label>Cancel Existing Variation Orders</label>
        <locationX>50</locationX>
        <locationY>1298</locationY>
        <connector>
            <targetReference>Assign_new_variation_values</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ContractId</field>
            <operator>In</operator>
            <value>
                <elementReference>Pre_Existing_Variations</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </inputAssignments>
        <object>Order</object>
    </recordUpdates>
    <recordUpdates>
        <description>Clears the old Active Contract field as this record is the active version and requires no reference to itself.
Without this step the field populates with the previous active version.</description>
        <name>Clear_active_contract_field_in_current_active_contract</name>
        <label>Clear active contract field in current active contract</label>
        <locationX>182</locationX>
        <locationY>3686</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>In</operator>
            <value>
                <elementReference>All_Variations</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Active_Variation_Contract__c</field>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <description>Changes status of the original contract to cancelled and stamps the current active version on the record.</description>
        <name>Mark_Original_Contract_Cancelled</name>
        <label>Mark Original Contract Cancelled</label>
        <locationX>182</locationX>
        <locationY>2762</locationY>
        <connector>
            <targetReference>Get_all_contracts_with_parent_equal_to_triggering_record_ID</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value18</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Active_Variation_Contract__c</field>
            <value>
                <elementReference>Get_original_Contract.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <description>Mark original contract orders as cancelled, EXCEPT those which have Activates status.</description>
        <name>Mark_original_contract_orders_as_cancelled</name>
        <label>Mark original contract orders as cancelled</label>
        <locationX>182</locationX>
        <locationY>2654</locationY>
        <connector>
            <targetReference>Mark_Original_Contract_Cancelled</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ContractId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_values_for_order_creation.Value18</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Activated</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </inputAssignments>
        <object>Order</object>
    </recordUpdates>
    <recordUpdates>
        <description>Updates the Active Contract field on all prior variations to provide a direct link to the current contract from any non-current version.</description>
        <name>Update_active_version_field_on_all_old_records</name>
        <label>Update active version field on all old records</label>
        <locationX>50</locationX>
        <locationY>3494</locationY>
        <connector>
            <targetReference>Clear_active_contract_field_in_current_active_contract</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>In</operator>
            <value>
                <elementReference>All_Variations</elementReference>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Cancelled</stringValue>
            </value>
        </filters>
        <inputAssignments>
            <field>Active_Variation_Contract__c</field>
            <value>
                <elementReference>New_Contract_Id</elementReference>
            </value>
        </inputAssignments>
        <object>Contract</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_ER_Order</name>
        <label>Update ER Order</label>
        <locationX>2074</locationX>
        <locationY>1214</locationY>
        <connector>
            <targetReference>Loop_through_to_the_orderItems_Collection_0</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_existing_order_record.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value02</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Case__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value03</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Charge_To__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value08</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CompanyAuthorizedById</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value07</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContractId</field>
            <value>
                <elementReference>Get_contractId_from_existing_case.Contract__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>EffectiveDate</field>
            <value>
                <elementReference>OrderStartDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Provider__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value06</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ReturnTo__c</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value09</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Short_Description__c</field>
            <value>
                <elementReference>orderShortDescription</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <elementReference>Get_values_for_order_creation.Value10</elementReference>
            </value>
        </inputAssignments>
        <object>Order</object>
    </recordUpdates>
    <start>
        <locationX>980</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Get_values_for_order_creation</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <textTemplates>
        <name>stringOfAllcreatedOrderItemIds</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>{!Get_all_created_orderItemIds}</text>
    </textTemplates>
    <textTemplates>
        <name>stringOfAllcreatedOrderItemIds0</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>{Get_all_created_orderItemIds_0}</text>
    </textTemplates>
    <textTemplates>
        <name>stringOfAllCreatedOrderItemsVariation</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;{!Get_all_created_orderItemIds_1}&lt;/p&gt;</text>
    </textTemplates>
    <textTemplates>
        <name>stringOfAllCreatedOrderItemsVariation0</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;&lt;span style=&quot;color: rgb(68, 68, 68); background-color: rgb(255, 255, 255);&quot;&gt;{!&lt;/span&gt;Copy_1_of_Copy_1_of_Get_all_created_orderItemIds&lt;span style=&quot;color: rgb(68, 68, 68); background-color: rgb(255, 255, 255);&quot;&gt;}&lt;/span&gt;&lt;/p&gt;</text>
    </textTemplates>
    <variables>
        <name>All_Variations</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>collectionoftheorderItemIdFromPS</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>currentItem_find_out_orderItems_need_to_be_deleted</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>Existing_Variations</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>Contract</objectType>
    </variables>
    <variables>
        <name>New_Contract_Id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>orderItemCollectionForCreationInUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>orderItemCollectionForUpdatingInUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>orderItemsCollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>orderItemSingleRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>orderItemSingleRecordForCreationInUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>orderItemSingleRecordForUpdatingInUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>Parent_Contract</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>PlatformServicesIntegrationRecords</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <objectType>N4l_Platform_services_integration__c</objectType>
    </variables>
    <variables>
        <name>Pre_Existing_Variations</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>SingleOrderItemId</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
</Flow>
