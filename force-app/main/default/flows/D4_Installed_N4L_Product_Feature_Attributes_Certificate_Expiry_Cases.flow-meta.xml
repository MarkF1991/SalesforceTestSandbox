<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>EmailAzure</name>
        <label>EmailAzure</label>
        <locationX>314</locationX>
        <locationY>2532</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>EmailtoPrincipal</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>EmailBodyAzure</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>EmailRecipients</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>sendRichBody</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>support@n4l.co.nz</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>EmailSubjectAzure</elementReference>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>EmailGoogle</name>
        <label>EmailGoogle</label>
        <locationX>50</locationX>
        <locationY>2532</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>EmailtoPrincipal</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>EmailBodyGoogle</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>EmailRecipients</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>sendRichBody</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>support@n4l.co.nz</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>EmailSubjectGoogle</elementReference>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <actionCalls>
        <name>EmailtoPrincipal</name>
        <label>EmailtoPrincipalChatterPost</label>
        <locationX>314</locationX>
        <locationY>2724</locationY>
        <actionName>chatterPost</actionName>
        <actionType>chatterPost</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>text</name>
            <value>
                <elementReference>ChatterPost</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>subjectNameOrId</name>
            <value>
                <elementReference>CreateCase</elementReference>
            </value>
        </inputParameters>
        <nameSegment>chatterPost</nameSegment>
        <storeOutputAutomatically>true</storeOutputAutomatically>
        <versionSegment>1</versionSegment>
    </actionCalls>
    <apiVersion>57.0</apiVersion>
    <assignments>
        <name>Assign_IT_Lead_Id</name>
        <label>Assign_IT_Lead_Id</label>
        <locationX>402</locationX>
        <locationY>1608</locationY>
        <assignmentItems>
            <assignToReference>IT_Lead_Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Find_IT_Lead.Contact.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Find_IT_Lead</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Principal_Id</name>
        <label>Assign_Principal_Id</label>
        <locationX>402</locationX>
        <locationY>1116</locationY>
        <assignmentItems>
            <assignToReference>Principal_Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Find_Principal_Role.Contact.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Find_Principal_Role</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Create_or_Update_Case</name>
        <label>Create or Update Case?</label>
        <locationX>710</locationX>
        <locationY>684</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>CreateCase2</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>CertificateExpiryCases.Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Installed_N4L_Product_Feature__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Secure Access</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Installed_N4L_Product_Feature__r.Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Active</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Contacts</targetReference>
            </connector>
            <label>Create Case</label>
        </rules>
        <rules>
            <name>UpdateCase</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>CertificateExpiryCases.Id</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue></stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>DaysUntilExpiry</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>28.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>CertificateExpiryCases.OwnerId</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>Techops_User.Id</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>CertificateExpiryCases.Status</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Awaiting Customer Response</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>EscalateCase</targetReference>
            </connector>
            <label>UpdateCase</label>
        </rules>
    </decisions>
    <decisions>
        <name>Google_or_Azure</name>
        <label>Send Google or Azure Email?</label>
        <locationX>314</locationX>
        <locationY>2316</locationY>
        <defaultConnectorLabel>Default</defaultConnectorLabel>
        <rules>
            <name>Google</name>
            <conditionLogic>1 AND 2 AND 3 AND 4 AND (5 OR 6)</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SAML Connector Expiration Date</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Attribute__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>SAML Connector Expiration Date</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Days_until_Expiry__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Days_until_Expiry__c</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>56.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Principal_Contact.Email</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>IT_Lead_Contact.Email</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>EmailTemplateGoogle</targetReference>
            </connector>
            <label>Google</label>
        </rules>
        <rules>
            <name>Azure</name>
            <conditionLogic>1 AND 2 AND 3 AND 4 AND (5 OR 6)</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>AZURE</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Attribute__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>User Lifecycle Management</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Days_until_Expiry__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Days_until_Expiry__c</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>56.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Principal_Contact.Email</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>IT_Lead_Contact.Email</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>EmailTemplateAzure</targetReference>
            </connector>
            <label>Azure</label>
        </rules>
    </decisions>
    <decisions>
        <name>Role_Contain_IT_Lead</name>
        <label>Role_Contain_IT_Lead</label>
        <locationX>534</locationX>
        <locationY>1500</locationY>
        <defaultConnector>
            <targetReference>Find_IT_Lead</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>IT_Lead</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Find_IT_Lead.Roles</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>IT Lead</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_IT_Lead_Id</targetReference>
            </connector>
            <label>IT_Lead</label>
        </rules>
    </decisions>
    <decisions>
        <name>Role_Contain_Principal</name>
        <label>Role Contain Principal?</label>
        <locationX>534</locationX>
        <locationY>1008</locationY>
        <defaultConnector>
            <targetReference>Find_Principal_Role</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Principal</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Find_Principal_Role.Roles</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Principal</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Principal_Id</targetReference>
            </connector>
            <label>Principal</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>CaseDescription</name>
        <dataType>String</dataType>
        <expression>LEFT($Api.Partner_Server_URL_260, FIND( &apos;/services&apos;, $Api.Partner_Server_URL_260))+{!$Record.Id}</expression>
    </formulas>
    <formulas>
        <description>Owner is &apos;holding bay owner&apos; or &apos;SA Engineering Queue&apos; depending upon the today is within 4 weeks of the expiry date.</description>
        <name>CaseOwner</name>
        <dataType>String</dataType>
        <expression>IF( {!$Record.Expiry_Date__c} - today() &lt;=28, {!SAEngineeringQueue.Id}, {!Techops_User.Id})</expression>
    </formulas>
    <formulas>
        <name>CaseStatus</name>
        <dataType>String</dataType>
        <expression>IF( {!$Record.Expiry_Date__c} - today() &lt;=28, &apos;Escalated&apos; ,&apos;Awaiting Customer Response&apos;)</expression>
    </formulas>
    <formulas>
        <description>Generated the case subject based on details in the &apos;Installed N4L Product Feature Attributes&apos; record.</description>
        <name>CaseSubject</name>
        <dataType>String</dataType>
        <expression>IF({!$Record.Name} = &quot;AZURE&quot;,  &quot;Azure app registration&quot;,  &quot;Google certificate of&quot;)</expression>
    </formulas>
    <formulas>
        <description>Chatter post on case to signify email has been sent</description>
        <name>ChatterPost</name>
        <dataType>String</dataType>
        <expression>IF({!$Record.Name} = &quot;AZURE&quot;,  &apos;Email sent to Principal &amp; IT Lead: &quot;Azure App Secret renewal&quot;&apos;,  &apos;Email sent to Principal &amp; IT Lead: &quot;	Google Certificate Renewal&quot;&apos;)</expression>
    </formulas>
    <formulas>
        <name>DaysUntilExpiry</name>
        <dataType>Number</dataType>
        <expression>{!$Record.Expiry_Date__c} - today()</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>EmailBodyAzure</name>
        <dataType>String</dataType>
        <expression>SUBSTITUTE(SUBSTITUTE(SUBSTITUTE({!EmailTemplateAzure.HtmlValue}, &quot;[!Contact.FirstName]&quot;, {!Principal_Contact.FirstName}) , &quot;[ExpiryDate]&quot;,   {!ExpiryDate}) ,  &quot;[!Case.Case_Thread_ID__c]&quot;, {!CaseCreated.Case_Thread_ID__c})</expression>
    </formulas>
    <formulas>
        <name>EmailBodyGoogle</name>
        <dataType>String</dataType>
        <expression>SUBSTITUTE( SUBSTITUTE(SUBSTITUTE({!EmailTemplateGoogle.HtmlValue}, &quot;[!Contact.FirstName]&quot;, {!Principal_Contact.FirstName}) , &quot;[ExpiryDate]&quot;,  {!ExpiryDate}), &quot;[!Case.Case_Thread_ID__c]&quot; , {!CaseCreated.Case_Thread_ID__c})</expression>
    </formulas>
    <formulas>
        <name>EmailRecipients</name>
        <dataType>String</dataType>
        <expression>{!Principal_Contact.Email}+&quot;,&quot;+  {!IT_Lead_Contact.Email}</expression>
    </formulas>
    <formulas>
        <name>EmailSubjectAzure</name>
        <dataType>String</dataType>
        <expression>{!EmailTemplateAzure.Subject}</expression>
    </formulas>
    <formulas>
        <name>EmailSubjectGoogle</name>
        <dataType>String</dataType>
        <expression>{!EmailTemplateGoogle.Subject}</expression>
    </formulas>
    <formulas>
        <name>ExpiryDate</name>
        <dataType>String</dataType>
        <expression>TEXT(DAY({!$Record.Expiry_Date__c}))+ &quot;/&quot; + TEXT(MONTH({!$Record.Expiry_Date__c}))+ &quot;/&quot; + TEXT(YEAR({!$Record.Expiry_Date__c}))</expression>
    </formulas>
    <formulas>
        <description>The type of the &apos;Installed N4L Product Feature Attributes&apos; record that determines the type of case to query.</description>
        <name>RecordType</name>
        <dataType>String</dataType>
        <expression>IF({!$Record.Name} = &quot;AZURE&quot;, &quot;Renew the Azure app registration&quot;, 
IF({!$Record.Name} = &quot;SAML Connector Expiration Date&quot; , &quot;Renew the Google certificate&quot;, &quot;&quot;))</expression>
    </formulas>
    <interviewLabel>D4-Installed N4L Product Feature Attributes - Certificate Expiry Cases {!$Flow.CurrentDateTime}</interviewLabel>
    <label>D4-Installed N4L Product Feature Attributes - Certificate Expiry Cases</label>
    <loops>
        <name>Find_IT_Lead</name>
        <label>Find_IT_Lead</label>
        <locationX>314</locationX>
        <locationY>1392</locationY>
        <collectionReference>Get_Contacts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Role_Contain_IT_Lead</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Principal_Contact</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Find_Principal_Role</name>
        <label>Find Principal Role</label>
        <locationX>314</locationX>
        <locationY>900</locationY>
        <collectionReference>Get_Contacts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Role_Contain_Principal</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Find_IT_Lead</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>CreateCase</name>
        <label>CreateCase</label>
        <locationX>314</locationX>
        <locationY>2100</locationY>
        <connector>
            <targetReference>CaseCreated</targetReference>
        </connector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>$Record.Installed_N4L_Product_Feature__r.Organisation__r.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Awaiting_Customer_Reminder_Turned_Off__c</field>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ContactId</field>
            <value>
                <elementReference>Principal_Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Description</field>
            <value>
                <elementReference>CaseDescription</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>CaseOwner</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Product__c</field>
            <value>
                <stringValue>MNttC - SA</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RecordTypeId</field>
            <value>
                <elementReference>RecordTypeId.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Secondary_Contact__c</field>
            <value>
                <elementReference>IT_Lead_Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <elementReference>CaseStatus</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Subject</field>
            <value>
                <stringValue>IMPORTANT: Renew the {!CaseSubject}  {!$Record.Installed_N4L_Product_Feature__r.Organisation__r.Name}  before  {!$Record.Expiry_Date__c}</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <stringValue>Certificate Management</stringValue>
            </value>
        </inputAssignments>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>CaseCreated</name>
        <label>CaseCreated</label>
        <locationX>314</locationX>
        <locationY>2208</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Google_or_Azure</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>CreateCase</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Check whether there are any Certificate Expiry cases already open for this School.</description>
        <name>CertificateExpiryCases</name>
        <label>CertificateExpiryCases</label>
        <locationX>710</locationX>
        <locationY>360</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>SAEngineeringQueue</targetReference>
        </connector>
        <filterLogic>1 AND 2 AND (3 OR 4 OR 5 OR 6) AND 7 AND 8 AND 9</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Installed_N4L_Product_Feature__r.Organisation__r.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Type</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Certificate Management</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Under Action</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Awaiting Customer Response</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>New</stringValue>
            </value>
        </filters>
        <filters>
            <field>Status</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Escalated</stringValue>
            </value>
        </filters>
        <filters>
            <field>Subject</field>
            <operator>Contains</operator>
            <value>
                <elementReference>RecordType</elementReference>
            </value>
        </filters>
        <filters>
            <field>Product__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>MNttC - SA</stringValue>
            </value>
        </filters>
        <filters>
            <field>RecordTypeId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>RecordTypeId.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Case</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>EmailTemplateAzure</name>
        <label>EmailTemplateAzure</label>
        <locationX>314</locationX>
        <locationY>2424</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>EmailAzure</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Azure_App_Secret_renewal</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>EmailTemplate</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>EmailTemplateGoogle</name>
        <label>EmailTemplateGoogle</label>
        <locationX>50</locationX>
        <locationY>2424</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>EmailGoogle</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Google_Certificate_Renewal</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>EmailTemplate</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Contacts</name>
        <label>Get Contacts</label>
        <locationX>314</locationX>
        <locationY>792</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Find_Principal_Role</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Installed_N4L_Product_Feature__r.Organisation__r.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>IsActive</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Roles</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>AccountContactRelation</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>IT_Lead_Contact</name>
        <label>IT Lead</label>
        <locationX>314</locationX>
        <locationY>1992</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CreateCase</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>IT_Lead_Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Principal_Contact</name>
        <label>Principal</label>
        <locationX>314</locationX>
        <locationY>1884</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>IT_Lead_Contact</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Principal_Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get the Id for the &apos;N4l Work&apos; record type.</description>
        <name>RecordTypeId</name>
        <label>&apos;N4L Work&apos; RecordTypeId</label>
        <locationX>710</locationX>
        <locationY>252</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>CertificateExpiryCases</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>N4L_Work</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>RecordType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get the id of the SA Engineering Queue.</description>
        <name>SAEngineeringQueue</name>
        <label>SA Engineering Queue</label>
        <locationX>710</locationX>
        <locationY>468</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Techops_User</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>SA_Engineering_Queue</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Group</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Techops_User</name>
        <label>Techops User</label>
        <locationX>710</locationX>
        <locationY>576</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Create_or_Update_Case</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Username</field>
            <operator>Contains</operator>
            <value>
                <stringValue>techops@n4l.co.nz</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>EscalateCase</name>
        <label>EscalateCase</label>
        <locationX>842</locationX>
        <locationY>792</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>CertificateExpiryCases.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Coordination_Notes__c</field>
            <value>
                <stringValue>Reminder was sent to school but no response was received. SA will lose critical functionality four weeks from this message until new credentials are added. Case now requires escalation to get the relevant details from the school or their ICT.</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>SAEngineeringQueue.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Escalated</stringValue>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <start>
        <locationX>584</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>RecordTypeId</targetReference>
        </connector>
        <filterLogic>1 AND (2 OR 3) AND 4</filterLogic>
        <filters>
            <field>AttributeValue__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue></stringValue>
            </value>
        </filters>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>SAML Connector Expiration Date</stringValue>
            </value>
        </filters>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>AZURE</stringValue>
            </value>
        </filters>
        <filters>
            <field>Days_until_Expiry__c</field>
            <operator>LessThanOrEqualTo</operator>
            <value>
                <numberValue>56.0</numberValue>
            </value>
        </filters>
        <object>Installed_N4L_Product_Feature_Attributes__c</object>
        <schedule>
            <frequency>Daily</frequency>
            <startDate>2023-05-12</startDate>
            <startTime>14:40:00.000Z</startTime>
        </schedule>
        <triggerType>Scheduled</triggerType>
    </start>
    <status>Obsolete</status>
    <variables>
        <name>Cases</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Case</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_IT_Lead_0</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>AccountContactRelation</objectType>
    </variables>
    <variables>
        <name>currentItem_Filter_Principal_0</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>AccountContactRelation</objectType>
    </variables>
    <variables>
        <name>IT_Lead_Id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Principal_Id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
